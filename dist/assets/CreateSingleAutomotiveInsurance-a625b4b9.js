import{r as d,j as e,a as r}from"./jsx-runtime-9fe3b506.js";import{U as K,n as H,o as P,u as J,b as T,S as I,s as V}from"./index-29587d46.js";import{E as $,C as q}from"./Compas-df40770c.js";import{c as W}from"./automotive-insurance-a209c6c9.js";const B="/assets/Source-3f26bc24.svg",D="/assets/Destination-03d2190b.svg",A="/assets/AddLocation-f3eca9c1.svg",z=({tileSelectionEnable:y=!1,gridEnable:i=!1,insuranceTypes:x,location:s,setSideBar:t,elevation:S,draggable:_=!1,zoom:N,setZoom:F,insurances:L,address:w,sourceMarker:E,destinationMarker:f})=>{d.useEffect(()=>{var o;const u=document.getElementById("map");if(u){const n=new window.UnlSdk.Map({container:u,apiKey:K,vpmId:H,gridControl:i,tilesSelectorControl:y,center:s!=null&&s.lat&&(s!=null&&s.long)?[s==null?void 0:s.lat,s==null?void 0:s.long]:[103.857461,1.29512],zoom:N||14,interactive:!0,scrollZoom:!0,style:"https://api.maptiler.com/maps/streets/style.json?key=sv8EJBnh0hTAqRleRS4s"});let c;S?(n.setBearing(60),n.setPitch(80)):(n.setBearing(0),n.setPitch(0)),n.on("zoom",()=>{const l=n.getZoom();l&&F!=null&&F(l)}),n.on("load",function(){f&&(n.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[103.857461,1.29512],[103.85748,1.29393],[103.85856,1.29393],[103.85986,1.29371]]}}}),n.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#4158D0","line-width":8}}))});const m=document.getElementById("marker");if((o=m==null?void 0:m.parentNode)==null||o.removeChild(m),E){const l=k(P);c=new window.UnlSdk.Marker(l,{draggable:_}).setLngLat([103.857461,1.29512]).addTo(n)}if(f){const l=k(P);c=new window.UnlSdk.Marker(l,{draggable:_}).setLngLat([103.85986,1.29371]).addTo(n),M(c)}if(window.MapboxDraw&&i){const l=new window.MapboxDraw({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});n.addControl(l)}}},[x,S,L,s,w,E,f]);const M=u=>{var R;const o=document.getElementById("marker");(R=o==null?void 0:o.parentNode)==null||R.removeChild(o);const n=u==null?void 0:u.getElement(),c=document.createElement("div");c.id="marker";const m=document.createElement("p"),l=document.createElement("p"),C=document.createElement("p"),j=document.createElement("p"),h=document.createElement("span"),b=document.createElement("span");m.textContent="Time  :",l.textContent="Distance  :",h.textContent="30Mins",b.textContent="12Kms",m.appendChild(h),l.appendChild(b),C.textContent="Peck Seath St",j.textContent="Duxton Rd",c.className="pin-hover";const v=document.createElement("button");v.textContent="Confirm Location",v.className="location-popup-btn",c.appendChild(C),c.appendChild(j),c.appendChild(m),c.appendChild(l),c.appendChild(v),n==null||n.appendChild(c),v.addEventListener("click",()=>{t!=null&&t()})},k=u=>{const o=document.createElement("div"),n=document.createElement("span");return n.className="absolute top-5 left-6 text-white font-bold",n.textContent="1",o.appendChild(n),o.style.backgroundImage="url("+u+")",o.style.width=60+"px",o.style.height=60+"px",o};return e("div",{className:"map-container w-full h-full flex-1",id:"map"})},Y=({handleCreatePolciy:y,handleGeoData:i})=>{const[x,s]=d.useState("Risk");return r("div",{className:"max-w-96 w-1/5 p-5 bg-white",children:[r("div",{className:"w-full flex items-center py-4 px-3 border border-gray-variant-2 rounded-md shadow mb-3 gap-2",children:[e("img",{src:B,alt:"source"}),e("span",{className:"font-medium text-sm text-primary-gray",children:"46, Prince street, Middleborough,London"})]}),r("div",{className:"w-full flex items-center py-4 px-3 border border-gray-variant-2 rounded-md shadow mb-8 gap-2",children:[e("img",{src:D,alt:"destination"}),e("span",{className:"font-medium text-sm text-primary-gray",children:"46, Prince street, Middleborough,London"})]}),e("span",{className:"text-primary-gray mb-3 font-bold",children:"Risk Factors"}),r("div",{className:"flex flex-col justify-center gap-3 w-full",children:[r("div",{className:"w-full flex items-center font-medium text-base cursor-pointer mb-2",children:[e("div",{className:`w-1/2 border-b flex items-center justify-center py-3 px-5 font-bold ${x==="Risk"?"text-primary border-primary bg-[#F1F2F3]":"text-primary-gray border-primary-gray"}`,onClick:()=>s("Risk"),children:"Risk Factors"}),e("div",{className:`w-1/2 border-b flex items-center justify-center py-3 px-5 font-bold ${x==="Geo"?"text-primary border-primary bg-[#F1F2F3]":"text-primary-gray border-primary-gray"}`,onClick:()=>s("Geo"),children:"Geo Data"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"traffic",name:"traffic_flow_indication",onChange:t=>{i(t)}}),e("label",{htmlFor:"traffic",className:"font-bold text-primary-gray",children:"Traffic Flow indication"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"type",name:"road_type",onChange:t=>{i(t)}}),e("label",{htmlFor:"type",className:"font-bold text-primary-gray",children:"Road Type"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"direction",name:"road_direction",onChange:t=>{i(t)}}),e("label",{htmlFor:"direction",className:"font-bold text-primary-gray",children:"Road Direction"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"length",name:"road_length",onChange:t=>{i(t)}}),e("label",{htmlFor:"length",className:"font-bold text-primary-gray",children:"Road Length"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"turn",name:"road_turn_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"turn",className:"font-bold text-primary-gray",children:"Road Turn Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"junction",name:"junction_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"junction",className:"font-bold text-primary-gray",children:"Junction Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"traffic-light",name:"traffic_light_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"traffic-light",className:"font-bold text-primary-gray",children:"Traffic Light Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"accident",name:"accident_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"accident",className:"font-bold text-primary-gray",children:"Accident Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"flood",name:"vehicle_type",onChange:t=>{i(t)}}),e("label",{htmlFor:"flood",className:"font-bold text-primary-gray",children:"Vehicle Type"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"flood",name:"flood_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"flood",className:"font-bold text-primary-gray",children:"Flood Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"weather",name:"weather_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"weather",className:"font-bold text-primary-gray",children:"Weather Risk"})]}),r("div",{className:"flex items-center gap-1 py-3",children:[e("input",{type:"checkbox",className:"accent-primary-gray w-[17px] h-[17px]",id:"crime",name:"crime_risk",onChange:t=>{i(t)}}),e("label",{htmlFor:"crime",className:"font-bold text-primary-gray",children:"Crime Risk"})]})]}),e("button",{type:"submit",className:"primary-btn btn w-full h-12 p-3 mt-12",onClick:y,children:"Calculate Risk Score"})]})},ee=()=>{const[y,i]=d.useState("insurance"),[x,s]=d.useState(!1),[t,S]=d.useState(15),[_,N]=d.useState(""),[F,L]=d.useState(""),[w,E]=d.useState(""),[f,M]=d.useState(!1),[k,u]=d.useState(!1),[o,n]=d.useState(""),[c,m]=d.useState(""),l=J(),[C,j]=d.useState({traffic_flow_indication:"false",road_type:"false",road_direction:"false",road_length:"false",road_turn_risk:"false",junction_risk:"false",traffic_light_risk:"false",accident_risk:"false",vehicle_type:"false",flood_risk:"false",weather_risk:"false",crime_risk:"false"}),[h,b]=d.useState({lat:null,long:null}),v=T({mutationFn:V,onSuccess:a=>{var p,g;((p=a.data)==null?void 0:p.message)==="No results found"?m((g=a.data)==null?void 0:g.message):(a.data.data["geojson:properties"]["vocabulary:name"]&&L(a.data.data["geojson:properties"]["vocabulary:name"]),a.data.data["geojson:geometry"].coordinates[0]&&b({lat:a.data.data["geojson:geometry"].coordinates[0],long:a.data.data["geojson:geometry"].coordinates[1]}))},onError:a=>{var p,g;(g=(p=a.response)==null?void 0:p.data)!=null&&g.message&&console.log(a.response.data.message)}}),R=T({mutationFn:W,onSuccess:()=>{l("/automotive-insurance")},onError:a=>{var p,g;(g=(p=a.response)==null?void 0:p.data)!=null&&g.message&&console.log(a.response.data.message)}}),U=()=>{l("/automotive-insurance")},Z=a=>{var p;j({...C,[a.target.name]:(p=a.target.checked)==null?void 0:p.toString()})};return e("div",{children:y==="risk"?r("div",{className:" inset-0 w-full h-screen z-0 flex",children:[e(Y,{geoData:C,handleCreatePolciy:U,location:h,handleGeoData:a=>Z(a)}),e(z,{location:h,sidbar:y,draggable:!1})]}):r("div",{className:" inset-0 w-full h-screen z-0 flex",children:[r("div",{className:"bg-white top-2 left-20 z-20 absolute mt-[30px] w-[300px] rounded-5",children:[f?r("div",{className:"flex rounded-t-5 items-center w-full border-b border-gray-variant-2 pl-2 gap-2",children:[e("img",{src:B,alt:"source"}),e("div",{className:"font-medium text-sm text-primary-gray p-3.5 pl-0",children:w})]}):r("div",{className:"flex rounded-t-5 justify-between items-center w-full border-b border-gray-variant-2 pl-2",children:[e("input",{value:w,onChange:a=>{E(a.target.value),m("")},className:" pl-2 z-20 relative p-3.5 w-[230px] text-sm font-medium border-none focus:outline-none text-primary-gray  placeholder:text-[#8F8F8F] ",placeholder:"Search for address"}),!!w.length&&e("div",{className:"bg-primary flex items-center justify-center rounded-5 w-10 h-10 mr-2 cursor-pointer",onClick:()=>{M(!0),N("location")},children:e("img",{src:A,alt:"add"})})]}),f&&(k?r("div",{className:"flex rounded-b-5 items-center w-full border-b border-gray-variant-2 pl-1 gap-2",children:[e("img",{src:D,alt:"destination"}),e("div",{className:"font-medium text-sm text-primary-gray p-3.5 pl-0",children:o})]}):r("div",{className:"bg-white flex border-none rounded-b-5 justify-between items-center w-full pl-2",children:[e("input",{value:o,onChange:a=>{n(a.target.value),m("")},className:" pl-2 z-20 relative p-3.5 w-[230px] text-sm font-medium border-none focus:outline-none text-primary-gray  placeholder:text-[#8F8F8F] ",placeholder:"Search for address"}),!!o.length&&e("div",{className:"bg-primary flex items-center justify-center rounded-5 w-10 h-10 mr-2 cursor-pointer",onClick:()=>{u(!0),N("location")},children:e("img",{src:A,alt:"add"})})]})),c.length>0?e("p",{className:"font-medium border-solid border-gray-variant-1 pl-4 py-4 px-3 w-[300px] bg-white text-error text-sm",children:c}):null]}),e(z,{location:h,markerType:_,setSideBar:()=>i("risk"),sidbar:y,elevation:x,draggable:!0,zoom:t,setZoom:a=>S(a),region:F,sourceMarker:f,destinationMarker:k}),e("button",{title:"Elevation",className:"absolute right-2 top-5 px-1 bg-white cursor-pointer",onClick:()=>{s(a=>!a)},children:e("img",{src:$,alt:"elevation"})}),e("button",{title:"Marker",className:"absolute right-2 top-16 px-1 bg-white cursor-pointer",onClick:()=>{h.long&&h.lat?b({long:h.long,lat:h.lat}):b({long:1.29512,lat:103.857461}),N("compass")},children:e("img",{src:q,alt:"elevation"})}),v.isLoading&&e(I,{}),R.isLoading&&e(I,{})]})})};export{ee as default};
